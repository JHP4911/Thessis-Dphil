%!TEX root = ../../main.tex
\section{Discussion}
\label{sec:Discussion}

\subsubsection{RADDOSE-3D extensions to SAXS}
\label{subs:RADDOSE-3D extensions to SAXS}

The analysis of data from the two SAXS experiments have relied on extensions to RADDOSE-3D to allow it to simulate the SAXS data collection experiment.
In particular the three major additions were:
\begin{enumerate}
    \item implementation of a cylindrical sample geometry
    \item determination of the sample composition given a protein concentration
    \item attenuation of the X-ray beam due to a surrounding capillary.
\end{enumerate}
The cylinder geometry is now an explicit input option for the user to specify in a RADDOSE-3D job.
RADDOSE-3D then converts a the description of the cylinder provided by the user, diameter and height, to a polyhedral geometry description, which is the base crystal implementation.
In fact the current cuboid geometry implementation does exactly the same thing.
Currently the only shape modelled by RADDOSE-3D that isn't converted to a polyhedral representation for the simulation is the sphere.

Some of the RADDOSE-3D code was refactored so that the library of residue information (atomic composition, molecular weight) is now stored as a separate entity to the element database. This refactoring reduced the complexity of the implementation for RADDOSE-3D to read a FASTA sequence file. The extension for RADDOSE-3D to read any other type of sequence file should now be trivial.

RADDOSE-3D now implements a \textit{container} class which defines the material that houses the sample.
The attenuation of the beam by the container is considered for all experiments.
For SAXS experiments this is the capillary, whereas for MX it is assumed to be a container that is \textit{transparent} to X-rays.
However the user can define any container for any experiment, SAXS or MX. So it is very flexible.

It is worth mentioning that RADDOSE-3D has been written to be very modular so that extensions to existing functionality are as seamless as possible.
At the fundamental abstract level RADDOSE-3D essentially deals with three main objects: a sample, a beam and some experimental strategy to expose the sample to the beam.
The beam does not necessarily need to be a beam of X-rays if the properties are defined as such in a similar manner that the sample can currently be either a crystal or a liquid SAXS sample.

One of the currents drawbacks to the extension of RADDOSE-3D to simulate SAXS experiments is that the implementation does not yet support sample flow.
This is a common method used in SAXS experiments to mitigate radiation damage \cite{jeffries2015limiting}.
This sample flow results in any given small volume of fluid passing across the X-ray beam.
In RADDOSE-3D this situation reduces to how long a given volume of fluid is exposed to each region of the X-ray beam.
A sufficiently small discretisation of time would be necessary so that the fluid volume does not completely `pass' the entire beam in a single time step.
Care would be needed to avoid the case where the time discretisation is so small that the computation is unnecessarily long.

The formal tests for the SAXS extensions need to be written before the code is officially released.
However the code is currently public on the RADDOSE-3D Github repository in the branch named ``SAXS".
Alpha versions of the SAXS extensions have already been distributed to a few people to test the usability and find any bugs.

\subsubsection{Radioprotectant analysis}
\label{subs:Radioprotectant analysis}
Two experiments to compare the efficacy of different radioprotectants for SAXS samples have been carried out and analysed.
Although methods already exist to assess the similarity of frames in a pairwise manner, few established methods deal with determination of a threshold for merging frames.
This was necessary to compare the efficacy of various radioprotectants.
Therefore metrics were developed to establish thresholds for merging analysis to be able to compare radioprotectant efficacy in increasing radiation tolerance.

For experiment 1 the analysis performed by DATCMP gave a fidelity value which was a measure of the similarity between frame 1 and a subsequent frame.
Overall these frames resembled logistic curves hence a 4PL was fitted to the data.
Two metrics were then developed to give a merging threshold. The first metric was the total dose absorbed required reach an arbitrary fidelity value.
This metric is fundamentally flawed because there is no universal value to choose and would have to change for each comparison experiment.
It is also a relative metric i.e. it only compares the efficacy of one radioprotectant to another, but it does not give any absolute information about whether the frames at that fidelity value are damaged or not.

The second metric that was developed was the dose absorbed before reaching maximum curvature.
This metric is absolute in the sense that the threshold represents the point at which the fidelity values begin to deviate maximally from the initial frame(s).
A downside to the maximum curvature metric is that if it is being used to ultimately determine which frames to merge, then the value that is determined may be too strict.
If the overall curvature of the function is fairly small then it is possible that merging some frames beyond the threshold may still improve data quality because they may not be too significantly dissimilar.

Potentially a big problem with the fitting approach overall is that it relies on a parametric function to be fitted to data where there is no guarantee that the data obey that form.

More recently the DATCMP similarity analysis was extended to implement the CorMap test which assesses the similarity of two frames without need for estimating the experimental error.
As this is the default test in DATCMP, it is likely that this is the analysis that the community will adopt.
During the analysis of the SAXS data, there was no package available to generate the plots related to the CorMap analysis, including the pairwise CorMap plots (Figures \ref{fig:Pairwise correlation frames 1 and 2} and \ref{fig:Pairwise correlation frames 1 and 120}) themselves.
Therefore a library was written to perform all of the analysis and produce the plots as well.
This library is currently available on Github but soon the library will made into a distributable Python package.

Since the CorMap test on its own resulted in individual frames being detected as dissimilar despite immediate frames before and after being assessed as similar, a more robust metric was used whereby three consecutive dissimilar frames were detected to establish a merging threshold.
This metric was used to determine that there is a concentration dependence on the efficacy of individual radioprotectants. Some radioprotectants such as glycerol, ascorbate and sodium nitrate exhibited a positive dependence, whereas DTT showed a negative dependence.
It was also found that glycerol, ascorbate and ethylene glycol were the most effective scavengers at high concentrations $10\ mM$.
These compounds are all hydroxyl scavengers, a radical species which is known to be mobile at room temperature.
Whereas sodium nitrate, which is an electron scavenger generally does not protect as well.
DTT was found to be the most effective radioprotectant at lower concentrations $1\ mM$ and $2\ mM$.
\textcolor{red}{
    \begin{myenumerate}
        \item \hypertarget{todo:more chemical information}{\textbf{TODO:} Perhaps I may need more radiation chemistry}
        especially if there are words left over.
    \end{myenumerate}
}

One aspect that was not considered in the analysis is how the radioprotectants affect the environment of the sample.
It is known that DTT reduces disulphide bonds and undergoes oxidation for example.
Glycerol on the other hand is known to reduce the scattering intensities of the sample \cite{jeffries2015limiting}.
These are considerations that the experimenter must also take into account when deciding on which radioprotectant compound to use.

The heatmap shown in Figure~\ref{fig:heatmap - DTT} displays some exciting possibilities.
Firstly it shows that pairwise comparisons with the first frame alone may not necessarily be the best approach to get all of the information possible from SAXS data.
Secondly it shows distinct regions of frame similarity.
These regions may correspond to distinct and important molecular conformations that would otherwise not be seen.
This finding warrants further analysis to determine how physiologically important these regions actually are.
